<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Materiales y Fabricación</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: #fff;
            font-family: 'Arial', sans-serif;
        }
        .card {
            background-color: rgba(31, 64, 104, 0.8);
            border: none;
            border-radius: 15px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }
        .card:hover {
            transform: scale(1.02);
        }
        .btn-primary {
            background-color: #1cb5e0;
            border: none;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #000046;
        }
        .navbar {
            background-color: rgba(31, 64, 104, 0.9);
            border-bottom: 2px solid #1cb5e0;
        }
        .navbar-brand {
            font-weight: bold;
            color: #1cb5e0;
        }
        textarea, input {
            background-color: rgba(255, 255, 255, 0.1);
            color: #fff;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Gestión de Materiales</a>
    </div>
</nav>

<div class="container my-5">
    <div class="row">
        <!-- Sección de materiales -->
        <div class="col-md-6">
            <div class="card p-3 mb-4">
                <h5 class="card-title">Agregar Material</h5>
                <form id="addMaterialForm">
                    <div class="mb-3">
                        <label for="materialName" class="form-label">Nombre del Material</label>
                        <input type="text" class="form-control" id="materialName" placeholder="Ej: Metal Chatarra">
                    </div>
                    <div class="mb-3">
                        <label for="materialQuantity" class="form-label">Cantidad</label>
                        <input type="number" class="form-control" id="materialQuantity" placeholder="Ej: 100">
                    </div>
                    <button type="button" class="btn btn-primary" onclick="addMaterial()">Agregar</button>
                </form>
            </div>
            <div class="card p-3">
                <h5 class="card-title">Listado de Materiales</h5>
                <ul class="list-group" id="materialList"></ul>
                <button class="btn btn-success mt-3" onclick="downloadMaterials()">Guardar Materiales</button>
            </div>
        </div>

        <!-- Sección de fabricación -->
        <div class="col-md-6">
            <div class="card p-3 mb-4">
                <div id="productForm">
                    <h3>Agregar Producto</h3>
                    <label for="productName">Nombre del Producto:</label>
                    <input type="text" id="productName" class="form-control" placeholder="Nombre del producto">
                    <br>
                
                    <h4>Materiales requeridos:</h4>
                    <div>
                        <label for="Metal Chatarra">Metal Chatarra:</label>
                        <input type="number" id="Metal Chatarra" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Goma">Goma:</label>
                        <input type="number" id="Goma" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Acero">Acero:</label>
                        <input type="number" id="Acero" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Plástico">Plástico:</label>
                        <input type="number" id="Plástico" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Cobre">Cobre:</label>
                        <input type="number" id="Cobre" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Oro">Oro:</label>
                        <input type="number" id="Oro" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Hierro">Hierro:</label>
                        <input type="number" id="Hierro" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Lingotes de Plata">Lingotes de Plata:</label>
                        <input type="number" id="Lingotes de Plata" class="form-control" placeholder="Cantidad">
                    </div>
                    <div>
                        <label for="Vidrio">Vidrio:</label>
                        <input type="number" id="Vidrio" class="form-control" placeholder="Cantidad">
                    </div>
                    <br>
                    <button onclick="addProduct()" class="btn btn-success">Agregar Producto</button>
                </div>
                
            </div>
            <div class="card p-3">
                <h5 class="card-title">Calculadora de Bonos</h5>
                <form id="calculateBonusForm">
                    <div class="mb-3">
                        <label for="selectedProduct" class="form-label">Producto</label>
                        <select class="form-select" id="selectedProduct"></select>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="calculateBonus()">Calcular</button>
                </form>
                <p id="bonusResult" class="mt-3"></p>
            </div>
        </div>
    </div>
</div>

<script>
    let materials = JSON.parse(localStorage.getItem('materials')) || [];
    const products = {};

    // Función para agregar o sumar cantidad a un material
    function addMaterial() {
        const name = document.getElementById('materialName').value.trim();
        const quantity = parseInt(document.getElementById('materialQuantity').value);

        if (name && quantity > 0) {
            const existingMaterial = materials.find(material => material.name.toLowerCase() === name.toLowerCase());

            if (existingMaterial) {
                existingMaterial.quantity += quantity;
            } else {
                materials.push({ name, quantity });
            }

            saveMaterials();
            updateMaterialList();
        } else {
            alert("Por favor, ingresa un nombre y una cantidad válida.");
        }
    }

    function updateMaterialList() {
        const materialList = document.getElementById('materialList');
        materialList.innerHTML = '';
        materials.forEach((material, index) => {
            materialList.innerHTML += `<li class="list-group-item d-flex justify-content-between align-items-center">
                ${material.name} - ${material.quantity}
                <button class="btn btn-sm btn-danger" onclick="removeMaterial(${index})">Eliminar</button>
            </li>`;
        });
    }

    function removeMaterial(index) {
        materials.splice(index, 1);
        saveMaterials();
        updateMaterialList();
    }

    function saveMaterials() {
        localStorage.setItem('materials', JSON.stringify(materials));
    }

    // Función para agregar un producto con materiales requeridos
    function addProduct() {
        const name = document.getElementById('productName').value.trim();
        const materialsRequired = {};

        // Obtener valores de cada material
        ['Metal Chatarra', 'Goma', 'Acero', 'Plástico', 'Cobre', 'Oro', 'Hierro', 'Lingotes de Plata', 'Vidrio'].forEach(material => {
            const quantity = parseInt(document.getElementById(material).value) || 0;
            if (quantity > 0) {
                materialsRequired[material] = quantity;
            }
        });

        if (name && Object.keys(materialsRequired).length > 0) {
            products[name] = materialsRequired;
            updateProductOptions();
            alert("Producto agregado correctamente.");
        } else {
            alert("Por favor, ingresa un nombre de producto y materiales requeridos válidos.");
        }
    }

    function updateProductOptions() {
        const productSelect = document.getElementById('selectedProduct');
        productSelect.innerHTML = '';
        Object.keys(products).forEach(product => {
            productSelect.innerHTML += `<option value="${product}">${product}</option>`;
        });
    }

    function calculateBonus() {
        const productName = document.getElementById('selectedProduct').value;
        const materialsRequired = products[productName];
        let totalBonos = 0;

        for (let material in materialsRequired) {
            if (materialsRequired.hasOwnProperty(material)) {
                const requiredAmount = materialsRequired[material];

                if (material === 'Metal Chatarra') totalBonos += requiredAmount / 25;
                if (material === 'Plástico') totalBonos += requiredAmount / 15;
                if (material === 'Acero') totalBonos += requiredAmount / 10;
                if (material === 'Goma') totalBonos += requiredAmount / 20;
            }
        }

        document.getElementById('bonusResult').innerText = `Bonos necesarios: ${Math.ceil(totalBonos)}`;
    }

    function downloadMaterials() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(materials));
        const downloadAnchor = document.createElement('a');
        downloadAnchor.setAttribute("href", dataStr);
        downloadAnchor.setAttribute("download", "materials.json");
        document.body.appendChild(downloadAnchor);
        downloadAnchor.click();
        downloadAnchor.remove();
    }

    // Cargar lista de materiales al iniciar
    updateMaterialList();
</script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
